<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>Babylon.js sample code</title>

    <!-- Babylon.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.2/dat.gui.min.js"></script>
    <script src="https://assets.babylonjs.com/generated/Assets.js"></script>
    <script src="https://preview.babylonjs.com/ammo.js"></script>
    <script src="https://preview.babylonjs.com/cannon.js"></script>
    <script src="https://preview.babylonjs.com/Oimo.js"></script>
    <script src="https://preview.babylonjs.com/earcut.min.js"></script>
    <script src="https://preview.babylonjs.com/babylon.js"></script>
    <script src="https://preview.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
    <script src="https://preview.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
    <script src="https://preview.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
    <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.js"></script>
    <script src="https://preview.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
    <script src="https://preview.babylonjs.com/gui/babylon.gui.min.js"></script>
    <script src="https://preview.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>

    <style>
        html,
        body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #renderCanvas {
            width: 100%;
            height: 100%;
            touch-action: none;
        }
    </style>
</head>

<body>
    <canvas id="renderCanvas"></canvas>
    <script>
        var canvas = document.getElementById("renderCanvas");

        var startRenderLoop = function (engine, canvas) {
            engine.runRenderLoop(function () {
                if (sceneToRender && sceneToRender.activeCamera) {
                    sceneToRender.render();
                }
            });
        }

        var engine = null;
        var scene = null;
        var sceneToRender = null;
        var createDefaultEngine = function () { return new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true, disableWebGL2Support: false }); };
        var createScene = function () {
            // This creates a basic Babylon Scene object (non-mesh)
            var scene = new BABYLON.Scene(engine);


            //   // This creates and positions a free camera (non-mesh)
            //     var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(0, 5, -10), scene);

            //     // This targets the camera to scene origin
            //     camera.setTarget(BABYLON.Vector3.Zero());

            var camera = new BABYLON.ArcRotateCamera("camera", BABYLON.Tools.ToRadians(90), BABYLON.Tools.ToRadians(65), 10, BABYLON.Vector3.Zero(), scene);

            // This attaches the camera to the canvas
            camera.attachControl(canvas, true);

            // This creates a light, aiming 0,1,0 - to the sky (non-mesh)
            var light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);

            // Default intensity is 1. Let's dim the light a small amount
            light.intensity = 0.7;

            // Our built-in 'ground' shape.
            var ground = BABYLON.MeshBuilder.CreateGround("ground", { width: 15, height: 15 }, scene);
            let groundMaterial = new BABYLON.StandardMaterial("Ground Material", scene);
            ground.material = groundMaterial;
            //ground.material.diffuseColor = BABYLON.Color3.Red();
            //let groundTexture = new BABYLON.Texture(Assets.textures.checkerboard_basecolor_png.rootUrl, scene);
             let groundTexture = new BABYLON.Texture("https://www.babylonjs-playground.com/textures/floor.png");
            ground.material.diffuseTexture = groundTexture;

            BABYLON.SceneLoader.ImportMesh("", Assets.meshes.Yeti.rootUrl, Assets.meshes.Yeti.filename, scene, function (newMeshes) {
                newMeshes[0].scaling = new BABYLON.Vector3(0.05, 0.05, 0.05);
                newMeshes[0].position = new BABYLON.Vector3(-1, 0, 3);
                newMeshes[0].rotation = new BABYLON.Vector3(0, Math.PI/12, 0);
            });

             //BABYLON.SceneLoader.ImportMeshAsync("", "https://assets.babylonjs.com/meshes/", "box.babylon");

        //    BABYLON.SceneLoader.ImportMeshAsync("", "https://assets.babylonjs.com/meshes/", "both_houses_scene.babylon").then((result) => {
        //    console.log(result);
        //    const house1 = scene.getMeshByName("detached_house");
        //     house1.position.z = 3;
        //    const house2 = result.meshes[2];
        //    house2.position.z = 3;
        //   });

        //    BABYLON.SceneLoader.ImportMeshAsync(["", "semi_house"], "https://assets.babylonjs.com/meshes/", "both_houses_scene.babylon");

        // Load the sound, give it time to load and play it every 3 seconds
          // const bounce = new BABYLON.Sound("bounce", "sounds/bounce.wav", scene);
        //setInterval(() => bounce.play(), 3000);


    

    /**** Materials *****/
    const roofMat = new BABYLON.StandardMaterial("roofMat");
   roofMat.diffuseTexture = new BABYLON.Texture("https://assets.babylonjs.com/environments/roof.jpg", scene);


   const boxMat = new BABYLON.StandardMaterial("boxMat");
   //boxMat.diffuseTexture = new BABYLON.Texture("https://www.babylonjs-playground.com/textures/floor.png");
   boxMat.diffuseTexture = new BABYLON.Texture("https://assets.babylonjs.com/environments/cubehouse.png")
  


   const roofMat2 = new BABYLON.StandardMaterial("roofMat2");
   roofMat2.diffuseColor = new BABYLON.Color3.Blue();
  

   const roofMat3 = new BABYLON.StandardMaterial("roofMat2");
   roofMat3.diffuseColor = new BABYLON.Color3(0, 1, 0);


    //options parameter to set different images on each side
    const faceUV = [];
    faceUV[0] = new BABYLON.Vector4(0.5, 0.0, 0.75, 1.0); //rear face
    faceUV[1] = new BABYLON.Vector4(0.0, 0.0, 0.25, 1.0); //front face
    faceUV[2] = new BABYLON.Vector4(0.25, 0, 0.5, 1.0); //right side
    faceUV[3] = new BABYLON.Vector4(0.75, 0, 1.0, 1.0); //left side
    // top 4 and bottom 5 not seen so not set

       /**** World Objects *****/
     const box1 = BABYLON.MeshBuilder.CreateBox("box1", {faceUV: faceUV, wrap: true});
    box1.position.y = 0.5;
    box1.rotation.y = Math.PI / 4;
    //box1.rotation.y = BABYLON.Tools.ToRadians(45);
     box1.material = boxMat;

    const box2 = BABYLON.MeshBuilder.CreateBox("box2", {});
    // box2.scaling.x = 2;
    // box2.scaling.y = 1.5;
    // box2.scaling.z = 3;
    box2.position = new BABYLON.Vector3(-3, 0.5, 0);
    box2.rotation.y = Math.PI / 4;

    const box3 = BABYLON.MeshBuilder.CreateBox("box3", {});
    //box3.scaling = new BABYLON.Vector3(2, 1.5, 3);
    box3.position.x  = 3;
    box3.position.y  = 0.5;
    box3.position.z  = 0;
    box3.rotation.y = Math.PI / 4;


    const roof = BABYLON.MeshBuilder.CreateCylinder("roof", {diameter: 1.3, height: 1.2, tessellation: 3});
    roof.position.y = 1.2;
    roof.scaling.x = 0.75;
    roof.rotation.z = Math.PI / 2;
    roof.rotation.y = Math.PI / 4;

    roof.material = roofMat;


     const roof2 = BABYLON.MeshBuilder.CreateCylinder("roof", {diameter: 1.3, height: 1.2, tessellation: 3});
     roof2.position = new BABYLON.Vector3(-3, 1.2, 0);
    roof2.scaling.x = 0.75;
    roof2.rotation.z = Math.PI / 2;
    roof2.rotation.y = Math.PI / 4;
     roof2.material = roofMat2;


     const roof3 = BABYLON.MeshBuilder.CreateCylinder("roof", {diameter: 1.3, height: 1.2, tessellation: 3});
    roof3.position = new BABYLON.Vector3(3, 1.2, 0);
    roof3.scaling.x = 0.75;
    roof3.rotation.z = Math.PI / 2;
    roof3.rotation.y = Math.PI / 4;

     roof3.material = roofMat3;



     //----------------kaishi

     


     const buildBox = () => {
    const boxMatm = new BABYLON.StandardMaterial("boxMat");
    boxMatm.diffuseTexture = new BABYLON.Texture("https://assets.babylonjs.com/environments/semihouse.png")


    //options parameter to set different images on each side
    const faceUVm = [];
    faceUVm[0] = new BABYLON.Vector4(0.6, 0.0, 1.0, 1.0); //rear face
    faceUVm[1] = new BABYLON.Vector4(0.0, 0.0, 0.4, 1.0); //front face
    faceUVm[2] = new BABYLON.Vector4(0.4, 0, 0.6, 1.0); //right side
    faceUVm[3] = new BABYLON.Vector4(0.4, 0, 0.6, 1.0); //left side
    // top 4 and bottom 5 not seen so not set
    

    /**** World Objects *****/
    const boxm = BABYLON.MeshBuilder.CreateBox("boxm", {width: 2, faceUV: faceUVm, wrap: true});
    boxm.material = boxMatm;
    boxm.position.y = 0.5;
    boxm.position.z = -5;

    return boxm;
}


const buildRoof = () => {
     //texture
    const roofMatm = new BABYLON.StandardMaterial("roofMat");
    roofMatm.diffuseTexture = new BABYLON.Texture("https://assets.babylonjs.com/environments/roof.jpg");
   


    const roofm = BABYLON.MeshBuilder.CreateCylinder("roofm", {diameter: 1.3, height: 1.2, tessellation: 3});
    roofm.material = roofMatm;
    roofm.scaling.x = 0.75;
    roofm.scaling.y = 2;
    roofm.rotation.z = Math.PI / 2;
    roofm.position.y = 1.22;
    roofm.position.z = -5;

      return roofm;
    
}

     const boxm = buildBox();
     const roofm = buildRoof();

    const house = BABYLON.Mesh.MergeMeshes([boxm, roofm], true, false, null, false, true);


            return scene;
        };  
        
        window.initFunction = async function () {


                var asyncEngineCreation = async function () {
                    try {
                        return createDefaultEngine();
                    } catch (e) {
                        console.log("the available createEngine function failed. Creating the default engine instead");
                        return createDefaultEngine();
                    }
                }

                window.engine = await asyncEngineCreation();
                if (!engine) throw 'engine should not be null.';
                startRenderLoop(engine, canvas);
                window.scene = createScene();
            };
            initFunction().then(() => {
                sceneToRender = scene
            });

            // Resize
            window.addEventListener("resize", function () {
                engine.resize();
            });
    </script>
</body>

</html>